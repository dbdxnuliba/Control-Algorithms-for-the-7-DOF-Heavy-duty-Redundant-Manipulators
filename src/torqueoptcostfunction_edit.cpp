
//Case1: both Gravity and TauE
//h=(K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))),2))/2 + (K1*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0])),2))/2 + (K2*(fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) - fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) - fgam*cos(q[1]) - fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) - falp*cos(q[0])*sin(q[1]) - fbet*sin(q[0])*sin(q[1]) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1])),2))/2 + (K4*(fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) - fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + fz*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))),2))/2 + (K5*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2]))),2))/2 + (K6*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))),2))/2 + (K3*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*sin(q[1])*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) + fgam*sin(q[1])*sin(q[2])),2))/2;

dhdq(0,0) = K4*(fy*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) 
			- cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) + fx*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) 
			+ cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + fbet*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + falp*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])))*(fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) 
			- fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) 
			+ fz*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + 
			falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + 
			g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) - K3*(falp*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + 
			fbet*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) - fx*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) 
			- cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - 
			falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) 
			- fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*sin(q[1])*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + 
			lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) + fgam*sin(q[1])*sin(q[2])) - K2*(fy*(d3*cos(q[0])*cos(q[1]) - 
			d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - fx*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) + fbet*cos(q[0])*sin(q[1]) - 
			falp*sin(q[0])*sin(q[1]))*(fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - 
			cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) - fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) - fgam*cos(q[1]) - 
			fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - 
			lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) - falp*cos(q[0])*sin(q[1]) - fbet*sin(q[0])*sin(q[1]) + g_acc*lg3*m3*sin(q[1]) + 
			g_acc*lg4*m4*sin(q[1])) + K7*(fbet*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + falp*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))) + 
			K6*(fbet*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + falp*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - 
			d7*fy*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - 
			d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + 
			K1*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0]))*(fy*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - fx*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + falp*cos(q[0]) + fbet*sin(q[0])) + K5*(falp*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fbet*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))))*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) 
			- sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])));

dhdq(1,0) = K3*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - falp*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) 
			+ cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*sin(q[1])*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + 
			lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) + fgam*sin(q[1])*sin(q[2]))*(fx*(d7*(sin(q[5])*(cos(q[0])*cos(q[2])*sin(q[1])*sin(q[4]) + 
			cos(q[0])*cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[0])*cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*cos(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + fy*(d7*(sin(q[5])*(cos(q[2])*sin(q[0])*sin(q[1])*sin(q[4]) + 
			cos(q[3])*cos(q[4])*sin(q[0])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + fz*(d7*(sin(q[5])*(cos(q[1])*cos(q[2])*sin(q[4]) + 
			cos(q[1])*cos(q[3])*cos(q[4])*sin(q[2])) + cos(q[1])*cos(q[5])*sin(q[2])*sin(q[3])) + d5*cos(q[1])*sin(q[2])*sin(q[3])) + g_acc*cos(q[1])*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) 
			+ lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) + fgam*cos(q[1])*sin(q[2]) + falp*cos(q[0])*sin(q[1])*sin(q[2]) + 
			fbet*sin(q[0])*sin(q[1])*sin(q[2])) - K4*(fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) - fgam*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) - fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + fz*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))*(fz*(d5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + d7*(cos(q[5])*(sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[4])*sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) - fx*(d7*(cos(q[5])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3]))) + d5*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1]))) - fgam*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3])) + falp*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) - fy*(d7*(cos(q[5])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) + 
			cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3]))) + d5*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1]))) + fbet*(cos(q[1])*cos(q[3])*sin(q[0]) - 
			cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) + g_acc*m7*(d5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + lg7*(cos(q[5])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[4])*sin(q[5])*(cos(q[3])*sin(q[1]) 
			+ cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*lg5*m5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + g_acc*lg6*m6*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3]))) + K5*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[1])*sin(q[2])))*(falp*(sin(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[0])*cos(q[4])*sin(q[1])*sin(q[2])) + fbet*(sin(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) + cos(q[4])*sin(q[0])*sin(q[1])*sin(q[2])) - fgam*(sin(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) - cos(q[1])*cos(q[4])*sin(q[2])) - 
			d7*fz*sin(q[5])*(sin(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) - cos(q[1])*cos(q[4])*sin(q[2])) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[0])*cos(q[4])*sin(q[1])*sin(q[2])) + d7*fy*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) + cos(q[4])*sin(q[0])*sin(q[1])*sin(q[2])) - 
			g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) - cos(q[1])*cos(q[4])*sin(q[2]))) + K2*(fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - 
			d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) - 
			fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - 
			cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) - fgam*cos(q[1]) - fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + 
			d3*sin(q[1])) - falp*cos(q[0])*sin(q[1]) - fbet*sin(q[0])*sin(q[1]) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1]))*(fx*(d3*cos(q[0])*sin(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[0])*cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d5*cos(q[0])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + 
			fy*(d5*sin(q[0])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - 
			cos(q[5])*sin(q[0])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[0])*sin(q[1])) + fgam*sin(q[1]) + fz*(d5*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - 
			d7*(sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])) + 
			g_acc*m5*(lg5*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) + d3*cos(q[1])) + g_acc*m6*(lg6*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) + d3*cos(q[1])) + g_acc*m7*(d5*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) - lg7*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			d3*cos(q[1])) - falp*cos(q[0])*cos(q[1]) - fbet*cos(q[1])*sin(q[0]) + g_acc*lg3*m3*cos(q[1]) + g_acc*lg4*m4*cos(q[1])) - K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - 
			sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))))*(falp*(cos(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) - 
			sin(q[5])*(cos(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + fbet*(cos(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - 
			cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) - sin(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + 
			fgam*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + 
			K1*(fx*(d7*(cos(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) - 
			sin(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + d5*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) + d3*cos(q[1])*sin(q[0])) - fy*(d7*(cos(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - 
			cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + d5*(cos(q[0])*cos(q[1])*cos(q[3]) - 
			cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) + d3*cos(q[0])*cos(q[1])))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0])) - 
			K6*(falp*(cos(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) - 
			cos(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + fbet*(cos(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) - sin(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + fgam*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d7*fz*(cos(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3]))) - d7*fx*(sin(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) + cos(q[5])*(cos(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) 
			- cos(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) - d7*fy*(sin(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) + cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) - sin(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - 
			d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))));

dhdq(2,0) = K5*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])))*(falp*(cos(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[3])*sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fbet*(cos(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*(cos(q[2])*cos(q[4])*sin(q[1]) - cos(q[3])*sin(q[1])*sin(q[2])*sin(q[4])) + d7*fz*sin(q[5])*(cos(q[2])*cos(q[4])*sin(q[1]) - cos(q[3])*sin(q[1])*sin(q[2])*sin(q[4])) + 
			d7*fx*sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[3])*sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*lg7*m7*sin(q[5])*(cos(q[2])*cos(q[4])*sin(q[1]) - cos(q[3])*sin(q[1])*sin(q[2])*sin(q[4]))) - 
			K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(falp*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fbet*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + 
			cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3]))) - K4*(fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) - fgam*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) - fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + fz*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))*(fy*(d7*(cos(q[3])*cos(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) - 
			cos(q[4])*sin(q[3])*sin(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + d5*cos(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - fx*(d7*(cos(q[3])*cos(q[5])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2])) - cos(q[4])*sin(q[3])*sin(q[5])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d5*cos(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			fz*(d7*(cos(q[3])*cos(q[5])*sin(q[1])*sin(q[2]) - cos(q[4])*sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])) + d5*cos(q[3])*sin(q[1])*sin(q[2])) - falp*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + 
			fbet*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + g_acc*m7*(lg7*(cos(q[3])*cos(q[5])*sin(q[1])*sin(q[2]) - cos(q[4])*sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])) + d5*cos(q[3])*sin(q[1])*sin(q[2])) + 
			fgam*sin(q[1])*sin(q[2])*sin(q[3]) + g_acc*lg5*m5*cos(q[3])*sin(q[1])*sin(q[2]) + g_acc*lg6*m6*cos(q[3])*sin(q[1])*sin(q[2])) - K6*(falp*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fbet*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			fgam*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d7*fx*(cos(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + sin(q[3])*sin(q[5])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*(cos(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + sin(q[3])*sin(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			d7*fz*(cos(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) - sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])) + g_acc*lg7*m7*(cos(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + 
			cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) - sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])))) - K1*(fx*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fy*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) 
			- cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) 
			- d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0])) + K3*(falp*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - fbet*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			fx*(d7*(sin(q[5])*(sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + cos(q[3])*cos(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2]))) + cos(q[5])*sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2]))) + d5*sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + 
			cos(q[3])*cos(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0]))) + cos(q[5])*sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0]))) + d5*sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0]))) 
			- fz*(d7*(sin(q[5])*(sin(q[1])*sin(q[2])*sin(q[4]) - cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[2])*cos(q[5])*sin(q[1])*sin(q[3])) - d5*cos(q[2])*sin(q[1])*sin(q[3])) + g_acc*sin(q[1])*(d5*m7*cos(q[2])*sin(q[3]) + 
			lg5*m5*cos(q[2])*sin(q[3]) + lg6*m6*cos(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*cos(q[5])*sin(q[3]) - lg7*m7*sin(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[2])*cos(q[3])*cos(q[4])*sin(q[5])) + 
			fgam*cos(q[2])*sin(q[1]))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - 
			falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) 
			- fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*sin(q[1])*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + 
			lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) + fgam*sin(q[1])*sin(q[2])) - 
			K2*(fx*(d7*(cos(q[0])*sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[0])*cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*cos(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + 
			fy*(d7*(sin(q[0])*sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + 
			fz*(d7*(sin(q[5])*(cos(q[1])*cos(q[2])*sin(q[4]) + cos(q[1])*cos(q[3])*cos(q[4])*sin(q[2])) + cos(q[1])*cos(q[5])*sin(q[2])*sin(q[3])) + d5*cos(q[1])*sin(q[2])*sin(q[3])) + 
			g_acc*m7*(lg7*(sin(q[5])*(cos(q[1])*cos(q[2])*sin(q[4]) + cos(q[1])*cos(q[3])*cos(q[4])*sin(q[2])) + cos(q[1])*cos(q[5])*sin(q[2])*sin(q[3])) + d5*cos(q[1])*sin(q[2])*sin(q[3])) + g_acc*lg5*m5*cos(q[1])*sin(q[2])*sin(q[3]) + 
			g_acc*lg6*m6*cos(q[1])*sin(q[2])*sin(q[3]))*(fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) - fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - 
			d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			d3*cos(q[1])*sin(q[0])) - fgam*cos(q[1]) - fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - 
			cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + 
			d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + 
			g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) - falp*cos(q[0])*sin(q[1]) - 
			fbet*sin(q[0])*sin(q[1]) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1]));

dhdq(3,0) = K4*(fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) 
			- cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) - fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - 
			fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + fz*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) - fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))*(fgam*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - fx*(d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) + d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) 
			- cos(q[0])*cos(q[3])*sin(q[1]))) + fy*(d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + fz*(d5*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) + d7*(cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))) + falp*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - fbet*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + g_acc*m7*(d5*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) + lg7*(cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))) + g_acc*lg5*m5*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) + g_acc*lg6*m6*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) - fbet*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])))) - K6*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - 
			sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))))*(fbet*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) - falp*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) - fgam*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d7*fz*(sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[4])*cos(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + d7*fx*(sin(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + cos(q[4])*cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) - d7*fy*(sin(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + 
			cos(q[4])*cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + g_acc*lg7*m7*(sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - 
			cos(q[4])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - K2*(fz*(d7*(sin(q[5])*(cos(q[3])*cos(q[4])*sin(q[1]) + cos(q[1])*cos(q[2])*cos(q[4])*sin(q[3])) + cos(q[5])*(sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3]))) + d5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3]))) - fy*(d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[3])*cos(q[4]) - cos(q[2])*cos(q[4])*sin(q[1])*sin(q[3])) + 
			cos(q[5])*sin(q[0])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) + d5*sin(q[0])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) - fx*(d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[3])*cos(q[4]) - 
			cos(q[2])*cos(q[4])*sin(q[1])*sin(q[3])) + cos(q[0])*cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) + d5*cos(q[0])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) + g_acc*m7*(d5*(sin(q[1])*sin(q[3]) 
			- cos(q[1])*cos(q[2])*cos(q[3])) + lg7*(cos(q[5])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[4])*sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*lg5*m5*(sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])) + g_acc*lg6*m6*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])))*(fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) - fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) - fgam*cos(q[1]) - fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*m7*(d5*(cos(q[3])*sin(q[1]) 
			+ cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) - 
			falp*cos(q[0])*sin(q[1]) - fbet*sin(q[0])*sin(q[1]) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1])) + K3*(fy*(d7*(cos(q[3])*cos(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) - 
			cos(q[4])*sin(q[3])*sin(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + d5*cos(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - fx*(d7*(cos(q[3])*cos(q[5])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2])) - cos(q[4])*sin(q[3])*sin(q[5])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d5*cos(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			fz*(d7*(cos(q[3])*cos(q[5])*sin(q[1])*sin(q[2]) - cos(q[4])*sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])) + d5*cos(q[3])*sin(q[1])*sin(q[2])) + g_acc*sin(q[1])*(d5*m7*cos(q[3])*sin(q[2]) + lg5*m5*cos(q[3])*sin(q[2]) + 
			lg6*m6*cos(q[3])*sin(q[2]) + lg7*m7*cos(q[3])*cos(q[5])*sin(q[2]) - lg7*m7*cos(q[4])*sin(q[2])*sin(q[3])*sin(q[5])))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + 
			cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + 
			fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) 
			+ g_acc*sin(q[1])*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + 
			lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) + fgam*sin(q[1])*sin(q[2])) + K5*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - 
			fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[1])*sin(q[2])))*(fgam*sin(q[4])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - falp*sin(q[4])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			fbet*sin(q[4])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*fz*sin(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - 
			d7*fx*sin(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*fy*sin(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + g_acc*lg7*m7*sin(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + K1*(fy*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) 
			+ cos(q[0])*sin(q[1])*sin(q[3]))) + fx*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + 
			fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - 
			fbet*cos(q[0]) + falp*sin(q[0]));

dhdq(4,0) = K5*(fgam*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - fbet*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + 
			sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			d7*fx*sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			g_acc*lg7*m7*sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])))*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2]))) - 
			K4*(d7*fz*sin(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*fx*sin(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			d7*fy*sin(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + g_acc*lg7*m7*sin(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])))*(fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) - fgam*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) - fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + fz*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) - K6*(fgam*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			falp*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			fbet*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			d7*fz*cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*cos(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*cos(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*lg7*m7*cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[1])*sin(q[2])))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - 
			d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - 
			K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + falp*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fbet*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + K3*(g_acc*sin(q[1])*(lg7*m7*cos(q[2])*cos(q[4])*sin(q[5]) - 
			lg7*m7*cos(q[3])*sin(q[2])*sin(q[4])*sin(q[5])) + d7*fz*sin(q[5])*(cos(q[2])*cos(q[4])*sin(q[1]) - cos(q[3])*sin(q[1])*sin(q[2])*sin(q[4])) + d7*fx*sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[3])*sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + 
			d5*sin(q[1])*sin(q[2])*sin(q[3])) - falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*sin(q[1])*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + 
			d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) + fgam*sin(q[1])*sin(q[2])) - 
			K1*(d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) 
			- cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) 
			- d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0])) - K2*(d7*fz*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[2]) - sin(q[1])*sin(q[3])*sin(q[4]) + cos(q[1])*cos(q[2])*cos(q[3])*sin(q[4])) + 
			d7*fx*cos(q[0])*sin(q[5])*(cos(q[4])*sin(q[1])*sin(q[2]) + cos(q[1])*sin(q[3])*sin(q[4]) + cos(q[2])*cos(q[3])*sin(q[1])*sin(q[4])) + d7*fy*sin(q[0])*sin(q[5])*(cos(q[4])*sin(q[1])*sin(q[2]) + cos(q[1])*sin(q[3])*sin(q[4]) 
			+ cos(q[2])*cos(q[3])*sin(q[1])*sin(q[4])) - g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) - cos(q[1])*cos(q[4])*sin(q[2])))*(fz*(d5*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + 
			d3*sin(q[1])) - fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - 
			cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) - fgam*cos(q[1]) - fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + 
			d3*sin(q[1])) - falp*cos(q[0])*sin(q[1]) - fbet*sin(q[0])*sin(q[1]) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1]));

dhdq(5,0) = K5*(d7*fz*cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*cos(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*cos(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*lg7*m7*cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[1])*sin(q[2])))*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2]))) - K6*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - 
			sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))))*(falp*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fgam*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - 
			sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - fbet*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d7*fx*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d7*fy*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d7*fz*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			g_acc*lg7*m7*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + 
			K3*(g_acc*sin(q[1])*(lg7*m7*cos(q[2])*cos(q[5])*sin(q[4]) - lg7*m7*sin(q[2])*sin(q[3])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*cos(q[5])*sin(q[2])) + d7*fx*(cos(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + sin(q[3])*sin(q[5])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*(cos(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + sin(q[3])*sin(q[5])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) + d7*fz*(cos(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) - sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + 
			cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) + g_acc*sin(q[1])*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + 
			lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) + fgam*sin(q[1])*sin(q[2])) - K1*(d7*fy*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			d7*fx*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0])) - 
			K4*(d7*fz*(sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[4])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d7*fx*(sin(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + cos(q[4])*cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) - 
			d7*fy*(sin(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + cos(q[4])*cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1]))) + g_acc*lg7*m7*(sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[4])*cos(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))))*(fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) - fgam*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) - fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + fz*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) + K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - falp*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			fbet*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))) + K2*(d7*fx*(cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) + cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d7*fy*(cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) + sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - d7*fz*(cos(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) + sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) - g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + 
			cos(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))))*(fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) - fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) - fgam*cos(q[1]) - fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + g_acc*m7*(d5*(cos(q[3])*sin(q[1]) 
			+ cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) - 
			falp*cos(q[0])*sin(q[1]) - fbet*sin(q[0])*sin(q[1]) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1]));

dhdq(6,0) = 0;

//Case2: Gravity only
//h=(K4*(g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))),2))/2 + (K2*(g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1])),2))/2 + (K3*g,2)*sin(q[1]),2)*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])),2))/2 + (K6*g,2)*lg7,2)*m7,2)*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))),2))/2 + (K5*g,2)*lg7,2)*m7,2)*sin(q[5]),2)*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])),2))/2;
dhdq(0,0) = 0;
dhdq(1,0) = K2*(g_acc*m5*(lg5*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) + d3*cos(q[1])) + g_acc*m6*(lg6*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) + d3*cos(q[1])) + 
			g_acc*m7*(d5*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - lg7*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])) + g_acc*lg3*m3*cos(q[1]) + g_acc*lg4*m4*cos(q[1]))*(g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - 
			lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1])) - K4*(g_acc*m7*(d5*(cos(q[1])*sin(q[3]) 
			+ cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))*(g_acc*m7*(d5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + lg7*(cos(q[5])*(sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[4])*sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*lg5*m5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + g_acc*lg6*m6*(sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3]))) + K3*pow(g,2)*cos(q[1])*sin(q[1])*pow((lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + 
			lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])),2) - K6*pow(g,2)*pow(lg7,2)*pow(m7,2)*(cos(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + 
			cos(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - K5*pow(g,2)*pow(lg7,2)*pow(m7,2)*pow(sin(q[5]),2)*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[1])*sin(q[2]))*(sin(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) - cos(q[1])*cos(q[4])*sin(q[2]));

dhdq(2,0) = K3*pow(g,2)*pow(sin(q[1]),2)*(d5*m7*cos(q[2])*sin(q[3]) + lg5*m5*cos(q[2])*sin(q[3]) + lg6*m6*cos(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*cos(q[5])*sin(q[3]) - lg7*m7*sin(q[2])*sin(q[4])*sin(q[5]) + 
			lg7*m7*cos(q[2])*cos(q[3])*cos(q[4])*sin(q[5]))*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + 
			lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) - K2*g_acc*cos(q[1])*(g_acc*m5*(d3*sin(q[1]) + lg5*cos(q[3])*sin(q[1]) + lg5*cos(q[1])*cos(q[2])*sin(q[3])) + g_acc*m6*(d3*sin(q[1]) + lg6*cos(q[3])*sin(q[1]) + 
			lg6*cos(q[1])*cos(q[2])*sin(q[3])) + g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - lg7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1]))*(lg5*m5*sin(q[2])*sin(q[3]) + 
			lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) - 
			K4*g_acc*sin(q[1])*sin(q[2])*(g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))*(d5*m7*cos(q[3]) + lg5*m5*cos(q[3]) + 
			lg6*m6*cos(q[3]) + lg7*m7*cos(q[3])*cos(q[5]) - lg7*m7*cos(q[4])*sin(q[3])*sin(q[5])) - K6*pow(g,2)*pow(lg7,2)*pow(m7,2)*sin(q[1])*(cos(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))*(cos(q[2])*cos(q[5])*sin(q[4]) - sin(q[2])*sin(q[3])*sin(q[5]) + cos(q[3])*cos(q[4])*cos(q[5])*sin(q[2])) + 
			K5*pow(g,2)*pow(lg7,2)*pow(m7,2)*sin(q[1])*sin(q[5]),2)*(cos(q[2])*cos(q[4]) - cos(q[3])*sin(q[2])*sin(q[4]))*(cos(q[4])*sin(q[1])*sin(q[2]) + cos(q[1])*sin(q[3])*sin(q[4]) + cos(q[2])*cos(q[3])*sin(q[1])*sin(q[4]));

dhdq(3,0) = K4*(g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))*(g_acc*m7*(d5*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) + lg7*(cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])))) + g_acc*lg5*m5*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) + g_acc*lg6*m6*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - K2*(g_acc*m7*(d5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + lg7*(cos(q[5])*(sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[4])*sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*lg5*m5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + g_acc*lg6*m6*(sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])))*(g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + 
			cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) 
			+ cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1])) + K3*pow(g,2)*pow(sin(q[1]),2)*(d5*m7*cos(q[3])*sin(q[2]) + lg5*m5*cos(q[3])*sin(q[2]) + lg6*m6*cos(q[3])*sin(q[2]) + 
			lg7*m7*cos(q[3])*cos(q[5])*sin(q[2]) - lg7*m7*cos(q[4])*sin(q[2])*sin(q[3])*sin(q[5]))*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + 
			lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) - K6*pow(g,2)*pow(lg7,2)*pow(m7,2)*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - 
			sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))*(sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[4])*cos(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + K5*pow(g,2)*pow(lg7,2)*pow(m7,2)*sin(q[4])*pow(sin(q[5]),2)*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2]))*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]));

dhdq(4,0) = K3*pow(g,2)*pow(sin(q[1]),2)*(lg7*m7*cos(q[2])*cos(q[4])*sin(q[5]) - lg7*m7*cos(q[3])*sin(q[2])*sin(q[4])*sin(q[5]))*(lg5*m5*sin(q[2])*sin(q[3]) + lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + 
			lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) - K6*pow(g,2)*pow(lg7,2)*pow(m7,2)*cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2]))*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + K5*pow(g,2)*pow(lg7,2)*pow(m7,2)*pow(sin(q[5]),2)*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2]))*(cos(q[4])*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + K2*g_acc*lg7*m7*sin(q[5])*(sin(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) - cos(q[1])*cos(q[4])*sin(q[2]))*(g_acc*m7*(d5*(cos(q[3])*sin(q[1]) 
			+ cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + 
			g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1])) - K4*g_acc*lg7*m7*sin(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))*(g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])));

dhdq(5,0) = K3*pow(g,2)*pow(sin(q[1]),2)*(lg7*m7*cos(q[2])*cos(q[5])*sin(q[4]) - lg7*m7*sin(q[2])*sin(q[3])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*cos(q[5])*sin(q[2]))*(lg5*m5*sin(q[2])*sin(q[3]) + 
			lg6*m6*sin(q[2])*sin(q[3]) + d5*m7*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[5])*sin(q[2])*sin(q[3]) + lg7*m7*cos(q[2])*sin(q[4])*sin(q[5]) + lg7*m7*cos(q[3])*cos(q[4])*sin(q[2])*sin(q[5])) - 
			K6*pow(g,2)*pow(lg7,2)*pow(m7,2)*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])))*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - 
			K2*g_acc*lg7*m7*(cos(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3])))*(g_acc*m7*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1]) - lg7*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + 
			cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + g_acc*m5*(lg5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*m6*(lg6*(cos(q[3])*sin(q[1]) 
			+ cos(q[1])*cos(q[2])*sin(q[3])) + d3*sin(q[1])) + g_acc*lg3*m3*sin(q[1]) + g_acc*lg4*m4*sin(q[1])) - K4*g_acc*lg7*m7*(sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - 
			cos(q[4])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))*(g_acc*m7*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + lg7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + g_acc*lg5*m5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + g_acc*lg6*m6*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) + 
			K5*pow(g,2)*pow(lg7,2)*pow(m7,2)*cos(q[5])*sin(q[5])*pow((sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])),2);

dhdq(6,0) = 0;

//Case3: TauE only
//h = (K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))),2))/2 + (K1*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0])),2))/2 + (K4*(fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) + fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) - fz*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))),2))/2 + (K3*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*sin(q[1])*sin(q[2])),2))/2 + (K5*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))),2))/2 + (K6*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))),2))/2 + (K2*(fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) + fgam*cos(q[1]) - fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) + falp*cos(q[0])*sin(q[1]) + fbet*sin(q[0])*sin(q[1])),2))/2; 
dhdq(0,0) = K5*(falp*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			fbet*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))))*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - 
			K4*(fy*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) + fx*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + 
			d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + fbet*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			falp*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])))*(fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) 
			- cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + 
			d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) + fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) - fz*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + K7*(fbet*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) 
			+ falp*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))) - K3*(falp*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fbet*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2])) - fx*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) 
			+ cos(q[0])*cos(q[1])*sin(q[2]))))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - 
			falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*sin(q[1])*sin(q[2])) + 
			K1*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) 
			- d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) 
			+ d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0]))*(fy*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) 
			+ cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) 
			- cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - fx*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) 
			- cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) 
			+ cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + falp*cos(q[0]) + fbet*sin(q[0])) + K2*(fy*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) 
			- fx*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - 
			cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) + fbet*cos(q[0])*sin(q[1]) - falp*sin(q[0])*sin(q[1]))*(fx*(d3*cos(q[0])*cos(q[1]) - 
			d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) + fgam*cos(q[1]) - 
			fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) + falp*cos(q[0])*sin(q[1]) + fbet*sin(q[0])*sin(q[1])) + K6*(fbet*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) 
			+ falp*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fy*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			d7*fx*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))));

dhdq(1,0) = K3*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - falp*(cos(q[2])*sin(q[0]) 
			+ cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			fgam*sin(q[1])*sin(q[2]))*(fx*(d7*(sin(q[5])*(cos(q[0])*cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[0])*cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[0])*cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + 
			d5*cos(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + fy*(d7*(sin(q[5])*(cos(q[2])*sin(q[0])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[0])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + 
			d5*sin(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + fz*(d7*(sin(q[5])*(cos(q[1])*cos(q[2])*sin(q[4]) + cos(q[1])*cos(q[3])*cos(q[4])*sin(q[2])) + cos(q[1])*cos(q[5])*sin(q[2])*sin(q[3])) + d5*cos(q[1])*sin(q[2])*sin(q[3])) + 
			fgam*cos(q[1])*sin(q[2]) + falp*cos(q[0])*sin(q[1])*sin(q[2]) + fbet*sin(q[0])*sin(q[1])*sin(q[2])) - K6*(falp*(cos(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) - 
			sin(q[5])*(cos(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + fbet*(cos(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - 
			cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) - sin(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + 
			fgam*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + 
			d7*fz*(cos(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) - 
			d7*fx*(sin(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) + cos(q[5])*(cos(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) - 
			cos(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) - d7*fy*(sin(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) + cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) - sin(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - 
			cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - K2*(fx*(d3*cos(q[0])*sin(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[0])*cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d5*cos(q[0])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + 
			fy*(d5*sin(q[0])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - 
			cos(q[5])*sin(q[0])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[0])*sin(q[1])) + fgam*sin(q[1]) + fz*(d5*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - 
			d7*(sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])) - 
			falp*cos(q[0])*cos(q[1]) - fbet*cos(q[1])*sin(q[0]))*(fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - 
			cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) 
			- d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			d3*cos(q[1])*sin(q[0])) + fgam*cos(q[1]) - fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) + falp*cos(q[0])*sin(q[1]) + fbet*sin(q[0])*sin(q[1])) - K4*(fgam*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3])) - fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) + 
			fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) - fz*(d5*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - falp*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) 
			- cos(q[0])*cos(q[3])*sin(q[1])) + fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])))*(fgam*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) + 
			fx*(d7*(cos(q[5])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3]))) + 
			d5*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1]))) - fz*(d5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + d7*(cos(q[5])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) + 
			cos(q[4])*sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) - falp*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) + fy*(d7*(cos(q[5])*(cos(q[1])*sin(q[0])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3]))) + d5*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1]))) - 
			fbet*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3]))) + K5*(falp*(sin(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[0])*cos(q[4])*sin(q[1])*sin(q[2])) 
			+ fbet*(sin(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) + cos(q[4])*sin(q[0])*sin(q[1])*sin(q[2])) - fgam*(sin(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) - 
			cos(q[1])*cos(q[4])*sin(q[2])) - d7*fz*sin(q[5])*(sin(q[4])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])) - cos(q[1])*cos(q[4])*sin(q[2])) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + 
			cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[0])*cos(q[4])*sin(q[1])*sin(q[2])) + d7*fy*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) + 
			cos(q[4])*sin(q[0])*sin(q[1])*sin(q[2])))*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - 
			K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(falp*(cos(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + 
			cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + fbet*(cos(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) - 
			sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) - sin(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + fgam*(sin(q[5])*(cos(q[4])*(sin(q[1])*sin(q[3]) - 
			cos(q[1])*cos(q[2])*cos(q[3])) + cos(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])))) + K1*(fx*(d7*(cos(q[5])*(cos(q[1])*cos(q[3])*sin(q[0]) - 
			cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[0])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[0])*sin(q[1])) - sin(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + d5*(cos(q[1])*cos(q[3])*sin(q[0]) - 
			cos(q[2])*sin(q[0])*sin(q[1])*sin(q[3])) + d3*cos(q[1])*sin(q[0])) - fy*(d7*(cos(q[5])*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) - sin(q[5])*(cos(q[4])*(cos(q[0])*cos(q[1])*sin(q[3]) + 
			cos(q[0])*cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[0])*sin(q[1])*sin(q[2])*sin(q[4]))) + d5*(cos(q[0])*cos(q[1])*cos(q[3]) - cos(q[0])*cos(q[2])*sin(q[1])*sin(q[3])) + 
			d3*cos(q[0])*cos(q[1])))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) 
			- d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) 
			+ d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0]));

dhdq(2,0) = K4*(fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3]))) + fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) - fz*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - falp*(sin(q[3])*(sin(q[0])*sin(q[2]) 
			- cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])))*(fy*(d7*(cos(q[3])*cos(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) - cos(q[4])*sin(q[3])*sin(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			d5*cos(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - fx*(d7*(cos(q[3])*cos(q[5])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) - cos(q[4])*sin(q[3])*sin(q[5])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) + d5*cos(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + fz*(d7*(cos(q[3])*cos(q[5])*sin(q[1])*sin(q[2]) - cos(q[4])*sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])) + 
			d5*cos(q[3])*sin(q[1])*sin(q[2])) - falp*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fgam*sin(q[1])*sin(q[2])*sin(q[3])) - 
			K1*(fx*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fy*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0])) + K3*(falp*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - fbet*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + fx*(d7*(sin(q[5])*(sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + cos(q[3])*cos(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2]))) + 
			cos(q[5])*sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2]))) + d5*sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])) + cos(q[3])*cos(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0]))) + cos(q[5])*sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0]))) + d5*sin(q[3])*(cos(q[0])*sin(q[2]) 
			+ cos(q[1])*cos(q[2])*sin(q[0]))) - fz*(d7*(sin(q[5])*(sin(q[1])*sin(q[2])*sin(q[4]) - cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[2])*cos(q[5])*sin(q[1])*sin(q[3])) - d5*cos(q[2])*sin(q[1])*sin(q[3])) + 
			fgam*cos(q[2])*sin(q[1]))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - 
			falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*sin(q[1])*sin(q[2])) - 
			K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(falp*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fbet*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + 
			cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3]))) - K6*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) 
			- d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))))*(falp*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fbet*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + 
			cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d7*fx*(cos(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			sin(q[3])*sin(q[5])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*(cos(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))) + sin(q[3])*sin(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + d7*fz*(cos(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) - 
			sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5]))) + K5*(falp*(cos(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[3])*sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			fbet*(cos(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*(cos(q[2])*cos(q[4])*sin(q[1]) - 
			cos(q[3])*sin(q[1])*sin(q[2])*sin(q[4])) + d7*fz*sin(q[5])*(cos(q[2])*cos(q[4])*sin(q[1]) - cos(q[3])*sin(q[1])*sin(q[2])*sin(q[4])) + d7*fx*sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[3])*sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))))*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			K2*(fx*(d7*(cos(q[0])*sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[0])*cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*cos(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + 
			fy*(d7*(sin(q[0])*sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[0])*sin(q[1])*sin(q[2])*sin(q[3])) + 
			fz*(d7*(sin(q[5])*(cos(q[1])*cos(q[2])*sin(q[4]) + cos(q[1])*cos(q[3])*cos(q[4])*sin(q[2])) + cos(q[1])*cos(q[5])*sin(q[2])*sin(q[3])) + d5*cos(q[1])*sin(q[2])*sin(q[3])))*(fx*(d3*cos(q[0])*cos(q[1]) - 
			d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) + fgam*cos(q[1]) - 
			fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) + falp*cos(q[0])*sin(q[1]) + fbet*sin(q[0])*sin(q[1]));

dhdq(3,0) = K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1]))) - fbet*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])))) - K4*(fgam*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - fx*(d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) 
			- cos(q[0])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) + d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + fy*(d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			cos(q[4])*sin(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) + d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1]))) + fz*(d5*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) + d7*(cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])))) + falp*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - fbet*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])))*(fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3]))) + fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) - fz*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - falp*(sin(q[3])*(sin(q[0])*sin(q[2]) 
			- cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) - 
			K2*(fy*(d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[3])*cos(q[4]) - cos(q[2])*cos(q[4])*sin(q[1])*sin(q[3])) + cos(q[5])*sin(q[0])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))) + d5*sin(q[0])*(cos(q[1])*sin(q[3]) 
			+ cos(q[2])*cos(q[3])*sin(q[1]))) - fz*(d7*(sin(q[5])*(cos(q[3])*cos(q[4])*sin(q[1]) + cos(q[1])*cos(q[2])*cos(q[4])*sin(q[3])) + cos(q[5])*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3]))) + 
			d5*(sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3]))) + fx*(d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[3])*cos(q[4]) - cos(q[2])*cos(q[4])*sin(q[1])*sin(q[3])) + cos(q[0])*cos(q[5])*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1]))) + d5*cos(q[0])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1]))))*(fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) 
			+ fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - 
			cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) + fgam*cos(q[1]) - fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - 
			d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) + 
			falp*cos(q[0])*sin(q[1]) + fbet*sin(q[0])*sin(q[1])) + K6*(fgam*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1]))) - fbet*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) - d7*fz*(sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[4])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - 
			d7*fx*(sin(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + cos(q[4])*cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1]))) + d7*fy*(sin(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + cos(q[4])*cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) 
			- d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + 
			K5*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))))*(fgam*sin(q[4])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - falp*sin(q[4])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) 
			+ fbet*sin(q[4])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*fz*sin(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - 
			d7*fx*sin(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*fy*sin(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1]))) + K1*(fy*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3]))) + 
			fx*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - 
			fbet*cos(q[0]) + falp*sin(q[0])) + K3*(fy*(d7*(cos(q[3])*cos(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) - cos(q[4])*sin(q[3])*sin(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			d5*cos(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - fx*(d7*(cos(q[3])*cos(q[5])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) - cos(q[4])*sin(q[3])*sin(q[5])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) + d5*cos(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + fz*(d7*(cos(q[3])*cos(q[5])*sin(q[1])*sin(q[2]) - cos(q[4])*sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])) + 
			d5*cos(q[3])*sin(q[1])*sin(q[2])))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - 
			falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*sin(q[1])*sin(q[2]));

dhdq(4,0) = K5*(fgam*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - fbet*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + 
			sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			d7*fx*sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))))*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			K2*(d7*fz*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[2]) - sin(q[1])*sin(q[3])*sin(q[4]) + cos(q[1])*cos(q[2])*cos(q[3])*sin(q[4])) + d7*fx*cos(q[0])*sin(q[5])*(cos(q[4])*sin(q[1])*sin(q[2]) + cos(q[1])*sin(q[3])*sin(q[4]) + 
			cos(q[2])*cos(q[3])*sin(q[1])*sin(q[4])) + d7*fy*sin(q[0])*sin(q[5])*(cos(q[4])*sin(q[1])*sin(q[2]) + cos(q[1])*sin(q[3])*sin(q[4]) + cos(q[2])*cos(q[3])*sin(q[1])*sin(q[4])))*(fx*(d3*cos(q[0])*cos(q[1]) - 
			d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - 
			sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) + fgam*cos(q[1]) - 
			fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + 
			cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) + falp*cos(q[0])*sin(q[1]) + fbet*sin(q[0])*sin(q[1])) + K4*(d7*fz*sin(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - 
			d7*fx*sin(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*fy*sin(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])))*(fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3]))) + fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) - fz*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - falp*(sin(q[3])*(sin(q[0])*sin(q[2]) 
			- cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) - 
			K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + falp*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fbet*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - K1*(d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - 
			fbet*cos(q[0]) + falp*sin(q[0])) + K3*(d7*fz*sin(q[5])*(cos(q[2])*cos(q[4])*sin(q[1]) - cos(q[3])*sin(q[1])*sin(q[2])*sin(q[4])) + d7*fx*sin(q[5])*(cos(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[3])*sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(cos(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - 
			falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*sin(q[1])*sin(q[2])) - 
			K6*(fgam*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + falp*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fbet*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + d7*fz*cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + 
			d7*fx*cos(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			d7*fy*cos(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2]))))*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - 
			d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + 
			d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))));

dhdq(5,0) = K5*(d7*fz*cos(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*cos(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*cos(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))*(fgam*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + 
			cos(q[4])*sin(q[1])*sin(q[2])) - fbet*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			falp*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + 
			d7*fz*sin(q[5])*(sin(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[1])*sin(q[2])) + d7*fx*sin(q[5])*(sin(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*sin(q[5])*(sin(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + K6*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) 
			- cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - d7*fx*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			d7*fy*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) + d7*fz*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))))*(fgam*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + sin(q[5])*(cos(q[1])*cos(q[3]) - 
			cos(q[2])*sin(q[1])*sin(q[3]))) - falp*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + fbet*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) 
			- d7*fx*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fy*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))) - 
			d7*fz*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) - cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) + 
			K4*(d7*fz*(sin(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - cos(q[4])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d7*fx*(sin(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + cos(q[4])*cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) - 
			d7*fy*(sin(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + cos(q[4])*cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + 
			cos(q[3])*sin(q[0])*sin(q[1]))))*(fgam*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - fx*(d7*(cos(q[5])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) - 
			cos(q[4])*sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1]))) + d5*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3]))) + fy*(d7*(cos(q[5])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) - cos(q[4])*sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) + d5*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3]))) - fz*(d5*(cos(q[1])*sin(q[3]) + 
			cos(q[2])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) + cos(q[4])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])))) - falp*(sin(q[3])*(sin(q[0])*sin(q[2]) 
			- cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + fbet*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1]))) - 
			K1*(d7*fy*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + 
			cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + d7*fx*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))))*(fy*(d5*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - 
			cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + 
			cos(q[0])*cos(q[1])*sin(q[2])))) - d3*cos(q[0])*sin(q[1])) + fx*(d5*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + d7*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])))) + d3*sin(q[0])*sin(q[1])) - fbet*cos(q[0]) + falp*sin(q[0])) + K7*(fgam*(sin(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) 
			- cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + falp*(cos(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) + 
			sin(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) - 
			fbet*(cos(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) + sin(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2])))))*(fgam*(cos(q[5])*(cos(q[4])*(cos(q[1])*sin(q[3]) + cos(q[2])*cos(q[3])*sin(q[1])) - sin(q[1])*sin(q[2])*sin(q[4])) + 
			sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - falp*(sin(q[5])*(sin(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[0])*cos(q[3])*sin(q[1])) - 
			cos(q[5])*(cos(q[4])*(cos(q[3])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) + cos(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])))) + 
			fbet*(sin(q[5])*(sin(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) + cos(q[3])*sin(q[0])*sin(q[1])) - cos(q[5])*(cos(q[4])*(cos(q[3])*(cos(q[0])*sin(q[2]) + cos(q[1])*cos(q[2])*sin(q[0])) - 
			sin(q[0])*sin(q[1])*sin(q[3])) + sin(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))))) + K3*(d7*fx*(cos(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - 
			cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) + sin(q[3])*sin(q[5])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d7*fy*(cos(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + sin(q[3])*sin(q[5])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) + 
			d7*fz*(cos(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) - sin(q[1])*sin(q[2])*sin(q[3])*sin(q[5])))*(fz*(d7*(sin(q[5])*(cos(q[2])*sin(q[1])*sin(q[4]) + 
			cos(q[3])*cos(q[4])*sin(q[1])*sin(q[2])) + cos(q[5])*sin(q[1])*sin(q[2])*sin(q[3])) + d5*sin(q[1])*sin(q[2])*sin(q[3])) - falp*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2])) + fbet*(cos(q[0])*cos(q[2]) - 
			cos(q[1])*sin(q[0])*sin(q[2])) + fx*(d7*(sin(q[5])*(sin(q[4])*(sin(q[0])*sin(q[2]) - cos(q[0])*cos(q[1])*cos(q[2])) - cos(q[3])*cos(q[4])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - 
			cos(q[5])*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - d5*sin(q[3])*(cos(q[2])*sin(q[0]) + cos(q[0])*cos(q[1])*sin(q[2]))) - fy*(d7*(sin(q[5])*(sin(q[4])*(cos(q[0])*sin(q[2]) + 
			cos(q[1])*cos(q[2])*sin(q[0])) - cos(q[3])*cos(q[4])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - cos(q[5])*sin(q[3])*(cos(q[0])*cos(q[2]) - cos(q[1])*sin(q[0])*sin(q[2]))) - d5*sin(q[3])*(cos(q[0])*cos(q[2]) 
			- cos(q[1])*sin(q[0])*sin(q[2]))) + fgam*sin(q[1])*sin(q[2])) - K2*(d7*fx*(cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) + 
			cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d7*fy*(cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) + 
			sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) - d7*fz*(cos(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) + 
			sin(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))))*(fx*(d3*cos(q[0])*cos(q[1]) - d7*(cos(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + 
			cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - cos(q[0])*cos(q[5])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d5*cos(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + 
			fy*(d5*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3])) - d7*(sin(q[0])*sin(q[5])*(cos(q[1])*cos(q[4])*sin(q[3]) - sin(q[1])*sin(q[2])*sin(q[4]) + cos(q[2])*cos(q[3])*cos(q[4])*sin(q[1])) - 
			cos(q[5])*sin(q[0])*(cos(q[1])*cos(q[3]) - cos(q[2])*sin(q[1])*sin(q[3]))) + d3*cos(q[1])*sin(q[0])) + fgam*cos(q[1]) - fz*(d5*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3])) - 
			d7*(sin(q[5])*(cos(q[1])*sin(q[2])*sin(q[4]) + cos(q[4])*sin(q[1])*sin(q[3]) - cos(q[1])*cos(q[2])*cos(q[3])*cos(q[4])) - cos(q[5])*(cos(q[3])*sin(q[1]) + cos(q[1])*cos(q[2])*sin(q[3]))) + d3*sin(q[1])) + 
			falp*cos(q[0])*sin(q[1]) + fbet*sin(q[0])*sin(q[1]));
			
dhdq(6,0) = 0;